<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dudu.soa.weixindubbo.weixin.http.accesstoken.mapper.AccessTokenDao">
    <resultMap type="com.dudu.soa.weixindubbo.weixin.http.module.parammodule.AccessToken" id="AccessToken">
        <id property="id" column="id"></id>
        <result property="appid" column="appid"/>
        <result property="appsecret" column="appsecret"/>
        <result property="token" column="token"/>
        <result property="ticket" column="ticket"/>
        <result property="expiresIn" column="expiresIn"/>
        <result property="createTime" column="createTime"/>
    </resultMap>

    <insert id="addAccessToken" parameterType="com.dudu.soa.weixindubbo.weixin.http.module.parammodule.AccessToken" useGeneratedKeys="true"
            keyProperty="id" flushCache="true">
        INSERT INTO
        DDWX_AccessToken (
        appid,
        appsecret,
        token,
        ticket,
        expiresIn,
        createTime

        )
        VALUES (
        #{appid},
        #{appsecret},
        #{token},
        #{ticket},
        #{expiresIn},
         #{createTime}
        )
    </insert>


    <select id="getAccessToken" parameterType="com.dudu.soa.weixindubbo.weixin.http.module.parammodule.AccessToken" resultMap="AccessToken">
        select top 1
        id,
          appid,
        appsecret,
        token,
        ticket,
        expiresIn,
        createTime
        from
        DDWX_AccessToken
        WHERE   appid =  #{appid}

    </select>


    <delete id="deletAccessToken" parameterType="com.dudu.soa.weixindubbo.weixin.http.module.parammodule.AccessToken" flushCache="true">
        delete from DDWX_AccessToken
        where  appid =  #{appid}

    </delete>


    <update id="updateAccessToken" parameterType="com.dudu.soa.weixindubbo.weixin.http.module.parammodule.AccessToken" flushCache="true">
        update DDWX_AccessToken
        <trim prefix="set" suffixOverrides=",">
            <if test="appsecret !=null and appsecret != ''">
                appsecret = #{appsecret},
            </if>
            <if test="token !=null and token != ''">
                token = #{token},
            </if>
            <if test="ticket !=null and ticket != ''">
                ticket = #{ticket},
            </if>
            <if test="createTime !=null and createTime != ''">
                createTime = #{createTime}
            </if>
        </trim>
        where
        appid =  #{appid}
    </update>


</mapper>
